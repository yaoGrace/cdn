<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<title>phpGrace 工具类库 - excel 读写操作</title>
<meta name="keywords" content="phpGrace 工具类库 - excel 读写操作" />
<meta name="description" content="phpGrace 工具类库 - excel 读写操作" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1" />
<link rel="stylesheet" href="../../statics/grace20200720.css" />
<link rel="stylesheet" href="https://at.alicdn.com/t/font_611166_2ypi64205d6.css" />
<script type="text/javascript" src="https://apps.bdimg.com/libs/jquery/2.1.4/jquery.min.js"></script>
<script type="text/javascript" src="../../statics/grace.js"></script>
</head>
<body>
<div class="grace-header">
	<div class="grace-main">
		<div class="grace-logo">
			<a href="../../index.html"><img src="../../statics/images/logo.png" /></a>
		</div>
		<ul class="grace-nav" id="grace-nav">
								<li><a href="javascript:;" onclick="showDownLoad()">下载</a></li>
								<li><a href="../../doc.html" id="nav-doc">手册</a></li>
			<li><a href="../../tools.html" id="nav-tool">工具</a></li>
			 
		</ul>
	</div>
	<div class="grace-menu" id="grace-menu"><i class="iconfont icon-menu"></i></div>
</div>
<div class="grace-header-line"></div>
<div class="grace-slide-menu" id="slide-menu-account">
	<a href="../../login.html">账户中心</a>
	<a href="../../login.html">我的话题</a>
	<a href="../../login.html">我的评论</a>
	<a href="../../index.html">退出系统</a>
</div>
<style type="text/css">.grace-info-title{line-height:2.2em; border-bottom:1px solid #F6F6F6; padding-bottom:12px;}
@media screen and (max-width:800px){
	.grace-rows1{display:none;}
	.grace-rows2{width:94%; padding:5px 2%;}
}
</style>
<div class="grace-line-banner"></div>
<div class="grace-main grace-margin-top">
	<div class="grace-l grace-rows1">
		<div class="grace-accordion" id="grace-accordion">
			<dl id="docdl-1">
				<dt><span class="iconfont icon-gongju"></span> 常用工具<i class="iconfont icon-jt-down"></i></dt>
								<dd><a href="11.html" id="doc-menu-11">图片处理类</a></dd>
								<dd><a href="6.html" id="doc-menu-6">文件上传类</a></dd>
								<dd><a href="3.html" id="doc-menu-3">ip地址获取类</a></dd>
								<dd><a href="5.html" id="doc-menu-5">验证码绘制类</a></dd>
								<dd><a href="18.html" id="doc-menu-18">日期时间换算类</a></dd>
								<dd><a href="4.html" id="doc-menu-4">md5加密类</a></dd>
								<dd><a href="7.html" id="doc-menu-7">服务器信息类</a></dd>
								<dd><a href="8.html" id="doc-menu-8">curl通信类</a></dd>
								<dd><a href="9.html" id="doc-menu-9">文件下载类</a></dd>
								<dd><a href="13.html" id="doc-menu-13">类反射工具</a></dd>
								<dd><a href="20.html" id="doc-menu-20">XML 生成与解析</a></dd>
								<dd><a href="21.html" id="doc-menu-21">汉字转拼音类</a></dd>
								<dd><a href="23.html" id="doc-menu-23">文件夹操作</a></dd>
								<dd><a href="22.html" id="doc-menu-22">人民币大写转换类</a></dd>
							</dl>
			<dl id="docdl-3">
				<dt><span class="iconfont icon-yingyongkuangjiachajian"></span>第三方类库整合<i class="iconfont icon-jt-down"></i></dt>
								<dd><a href="14.html" id="doc-menu-14">QQ登录 - web版</a></dd>
								<dd><a href="17.html" id="doc-menu-17">微信扫码登录-网站</a></dd>
								<dd><a href="16.html" id="doc-menu-16">excel 读写操作</a></dd>
								<dd><a href="15.html" id="doc-menu-15">阿里云短信接口</a></dd>
								<dd><a href="12.html" id="doc-menu-12">SMTP 邮件发送</a></dd>
								<dd><a href="10.html" id="doc-menu-10">二维码生成类</a></dd>
								<dd><a href="19.html" id="doc-menu-19">word、pdf 生成类</a></dd>
								<dd><a href="24.html" id="doc-menu-24">阿里云静态云存储接口类</a></dd>
								<dd><a href="25.html" id="doc-menu-25">支付宝-当面付接口类</a></dd>
							</dl>
		</div>
	</div>
	<div class="grace-r grace-rows2">
		<div class="grace-info-title">
			<h1 class="grace-h3 grace-color-green">excel 读写操作</h1>
		</div>
		<div class="grace-content" style="padding:12px 0px;">
			<p><strong>功能说明</strong><br/>excel 读写操作基于 PHPExecl 类库，可以方便的对 Excel 进行操作。<br/><br/><strong>部署说明</strong><br/></p><pre class="brush:php;toolbar:false">下载&nbsp;PHPExcel.zip&nbsp;解压后将全部文件部署到&nbsp;phpGrace/tools&nbsp;下</pre><p><br/><strong>调用说明</strong><br/>遵守第三方类库规则（加载、命名空间），使用 tool() 函数实例化。<br/><br/><strong>生成 Excel 演示</strong><br/></p><pre class="brush:php;toolbar:false">&lt;?php
class&nbsp;indexController&nbsp;extends&nbsp;grace{
&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;function&nbsp;index(){
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$excel&nbsp;=&nbsp;tool(&#39;PHPExcel&#39;);
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//基础信息
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$excel-&gt;getProperties()-&gt;setCreator(&quot;phpGrace&quot;)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&gt;setLastModifiedBy(&quot;phpGrace&quot;)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&gt;setTitle(&quot;phpGrace&nbsp;demo&quot;)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&gt;setSubject(&quot;objPHPExcel&quot;);
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//设置&nbsp;sheet&nbsp;名称
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$excel-&gt;getActiveSheet(0)-&gt;setTitle(&#39;学生信息表&#39;);
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//标题
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$excel-&gt;setActiveSheetIndex(0)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&gt;setCellValue(&#39;A1&#39;,&nbsp;&#39;姓名&#39;)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&gt;setCellValue(&#39;B1&#39;,&nbsp;&#39;性别&#39;)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&gt;setCellValue(&#39;C1&#39;,&nbsp;&#39;年龄&#39;);
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//数据填充【此数据可以来自数据库】
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$data&nbsp;=&nbsp;array(
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;array(&#39;张三&#39;,&nbsp;&#39;男&#39;,&nbsp;18),
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;array(&#39;李四&#39;,&nbsp;&#39;男&#39;,&nbsp;20),
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;array(&#39;lucy&#39;,&nbsp;&#39;女&#39;,&nbsp;18)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;);
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$i&nbsp;=&nbsp;2;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;foreach($data&nbsp;as&nbsp;$rows){
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$excel-&gt;setActiveSheetIndex(0)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&gt;setCellValue(&#39;A&#39;.$i,&nbsp;$rows[0])
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&gt;setCellValue(&#39;B&#39;.$i,&nbsp;$rows[1])
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&gt;setCellValue(&#39;C&#39;.$i,&nbsp;$rows[2]);
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$i++;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//保存为&nbsp;xls
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$objWriter&nbsp;=&nbsp;PHPExcel_IOFactory::createWriter($excel,&nbsp;&#39;Excel5&#39;);
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$objWriter-&gt;save(&#39;t.xls&#39;);
&nbsp;&nbsp;&nbsp;&nbsp;}
}</pre><p><br/><strong>读取 excel -&nbsp;tool(&#39;PHPExcelReader&#39;);<br/></strong>使用&nbsp;PHPExcelReader 可以快速的读取 excel 内容，返回数据格式：<br/></p><pre class="brush:php;toolbar:false">array(
&nbsp;&nbsp;&nbsp;&nbsp;//sheet&nbsp;数据，多个元素对应数组&nbsp;index
&nbsp;&nbsp;&nbsp;&nbsp;0&nbsp;=&gt;&nbsp;array(
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;工作表名
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#39;title&#39;&nbsp;=&gt;&nbsp;&#39;sheet&nbsp;名称&#39;,
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//工作表数据
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#39;data&#39;&nbsp;&nbsp;=&gt;&nbsp;array(
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//每一行数据
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0&nbsp;=&gt;&nbsp;array(单元内容,&nbsp;单元内容,...)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1&nbsp;=&gt;&nbsp;array(......)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;)
&nbsp;&nbsp;&nbsp;&nbsp;),
&nbsp;&nbsp;&nbsp;&nbsp;1&nbsp;=&gt;&nbsp;array(......)
);</pre><p><br/><strong>读取演示</strong><br/></p><pre class="brush:php;toolbar:false">&lt;?php
class&nbsp;indexController&nbsp;extends&nbsp;grace{
&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;function&nbsp;index(){
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//实例化&nbsp;excel&nbsp;读取对象
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$PHPExcelReader&nbsp;=&nbsp;tool(&#39;PHPExcelReader&#39;);
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//读取指定的&nbsp;excel&nbsp;文件
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$sheets&nbsp;=&nbsp;$PHPExcelReader-&gt;read(&#39;t.xls&#39;);
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;echo&nbsp;&#39;&lt;h2&gt;&#39;.$sheets[0][&quot;title&quot;].&#39;&lt;/h2&gt;&#39;;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;echo&nbsp;&#39;&lt;table&gt;&#39;;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;foreach($sheets[0][&#39;data&#39;]&nbsp;as&nbsp;$sheet){
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;echo&nbsp;&#39;&lt;tr&gt;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;td&gt;&#39;.$sheet[0].&#39;&lt;/td&gt;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;td&gt;&#39;.$sheet[1].&#39;&lt;/td&gt;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;td&gt;&#39;.$sheet[2].&#39;&lt;/td&gt;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/tr&gt;&#39;;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;echo&nbsp;&#39;&lt;/table&gt;&#39;;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;echo&nbsp;&#39;&lt;h2&gt;&#39;.$sheets[1][&quot;title&quot;].&#39;&lt;/h2&gt;&#39;;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;echo&nbsp;&#39;&lt;table&gt;&#39;;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;foreach($sheets[1][&#39;data&#39;]&nbsp;as&nbsp;$sheet){
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;echo&nbsp;&#39;&lt;tr&gt;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;td&gt;&#39;.$sheet[0].&#39;&lt;/td&gt;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;td&gt;&#39;.$sheet[1].&#39;&lt;/td&gt;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/tr&gt;&#39;;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;echo&nbsp;&#39;&lt;/table&gt;&#39;;
&nbsp;&nbsp;&nbsp;&nbsp;}
}</pre><p><br/>更多资料<br/>关于 PHPExcel 更多的介绍资料：&nbsp;<a href="https://blog.csdn.net/pengone/article/details/47724423" target="_blank">https://blog.csdn.net/pengone/article/details/47724423</a></p>		

<!-- 下载地址 -->
<strong>下载当前类库源码：</strong><br/> 
<a href="javascript:;">
	<img src="../../statics/images/down.png" onclick="window.open('https://cdn.jsdelivr.net/gh/yaoGrace/CdnStatics/FrontProject/phpgrace/PHPExcel.zip')" alt="">
   </a>	
   <strong>mac 系统环境 可以在编辑器的tools目录下通过 Terminal 执行命令行直接下载到目录里</strong>
   <pre>curl -O https://cdn.jsdelivr.net/gh/yaoGrace/CdnStatics/FrontProject/phpgrace/PHPExcel.zip</pre>
</div>
	</div>
</div>
<div class="grace-footer-line"></div>
<div class="grace-footer">
	phpGrace 轻快的实力派！&nbsp;&nbsp;
	<br/>
</div>
<script type="text/javascript">
function showDownLoad(){
	var gDialog = new graceDialog();
	gDialog.buttons = ['关闭', '知道了'];
	var msg = '<a href="https://gitee.com/liukuaizhuan/phpgrace" target="_blank" style="color:#5FB878; font-weight:700;"> 请点击这里去 gitee 下载 phpGrace ^_^</a>'+
			"<br /> 有gitee 账户的同学<br />请给我们一个星星作为鼓励谢谢 ^_^<br />" ;
	gDialog.alert(msg);
}
$('#grace-menu').click(function(){
	var nav = $('#grace-nav');
	if(nav.is(':hidden')){nav.slideDown(100);}else{nav.slideUp(100);}
});
//百度统计
//粘贴代码
</script><script type="text/javascript" src="http://apps.bdimg.com/libs/prettify/r298/prettify.js"></script>
<script type="text/javascript">
$('#nav-tool').addClass('grace-current');
$('#doc-menu-16').addClass('grace-current');
var index = $('#doc-menu-16').parent().parent().index();
$('#grace-accordion').accordion(index);
$('pre').addClass('prettyprint');
prettyPrint();
</script>
</body>
</html><script>console.log("phpGrace Log : 控制器 : tools, 方法 : info - 运行时间 : 6.64毫秒, 占用内存 : 50.46k");</script>