<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<title>生成带参数的二维码</title>
<meta name="keywords" content="生成带参数的二维码" />
<meta name="description" content="生成带参数的二维码" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1" />
<link rel="stylesheet" href="../../statics/grace20200720.css" />
<link rel="stylesheet" href="https://at.alicdn.com/t/font_611166_2ypi64205d6.css" />
<script type="text/javascript" src="https://apps.bdimg.com/libs/jquery/2.1.4/jquery.min.js"></script>
<script type="text/javascript" src="../../statics/grace.js"></script>
</head>
<body>
<div class="grace-header">
	<div class="grace-main">
		<div class="grace-logo">
			<a href="../../index.html"><img src="../../statics/images/logo.png" /></a>
		</div>
		<ul class="grace-nav" id="grace-nav">
								<li><a href="javascript:;" onclick="showDownLoad()">下载</a></li>
								<li><a href="../../doc.html" id="nav-doc">手册</a></li>
			<li><a href="../../tools.html" id="nav-tool">工具</a></li>
			 
		</ul>
	</div>
	<div class="grace-menu" id="grace-menu"><i class="iconfont icon-menu"></i></div>
</div>
<div class="grace-header-line"></div>
<div class="grace-slide-menu" id="slide-menu-account">
	<a href="../../login.html">账户中心</a>
	<a href="../../login.html">我的话题</a>
	<a href="../../login.html">我的评论</a>
	<a href="../../index.html">退出系统</a>
</div>
<style type="text/css">@media screen and (max-width:800px){
	.grace-rows1{display:none;}
	.grace-rows2{width:94%; padding:5px 2%;}
}
</style>
<div class="grace-line-banner"></div>
<div class="grace-main grace-margin-top">
	<div class="grace-rows1 grace-l">
		<div class="grace-accordion" id="grace-accordion">
	<dl id="docdl-0" class="grace-mobile-hide">
		<dt>graceWechat<i class="iconfont icon-jt-down"></i></dt>
		<dd class="grace-mobile-hide"><a href="../../wechat.html" id="doc-menu-0-0">graceWechat 介绍</a></dd>
	</dl>
	<dl id="docdl-1">
		<dt>微信公众号常用<i class="iconfont icon-jt-down"></i></dt>
		<dd><a href="328-1.html" id="doc-menu-1-328">公众号开发资料</a></dd>
		<dd><a href="329-1.html" id="doc-menu-1-329">快速接入公众号</a></dd>
		<dd><a href="330-1.html" id="doc-menu-1-330">关注、取消关注</a></dd>
		<dd><a href="331-1.html" id="doc-menu-1-331">接收、回复消息</a></dd>
		<dd><a href="332-1.html" id="doc-menu-1-332">消息数据日志</a></dd>
		<dd><a href="333-1.html" id="doc-menu-1-333">综合消息处理</a></dd>
		<dd><a href="334-1.html" id="doc-menu-1-334">Access Token</a></dd>
		<dd><a href="335-1.html" id="doc-menu-1-335">自定义菜单</a></dd>
		<dd><a href="336-1.html" id="doc-menu-1-336">临时素材管理</a></dd>
		<dd><a href="337-1.html" id="doc-menu-1-337">二维码生成及识别</a></dd>
		<dd><a href="338-1.html" id="doc-menu-1-338">长链转短链</a></dd>
		<dd><a href="339-1.html" id="doc-menu-1-339">模板消息</a></dd>
		<dd><a href="340-1.html" id="doc-menu-1-340">获取用户信息</a></dd>
	</dl>
	<dl id="docdl-2">
		<dt>网页开发及授权<i class="iconfont icon-jt-down"></i></dt>
		<dd><a href="341-2.html" id="doc-menu-2-341">前端框架推荐</a></dd>
		<dd><a href="342-2.html" id="doc-menu-2-342">微信网页授权</a></dd>
		<dd><a href="../../tools/info/17.html" target="_blank">微信扫码登录</a></dd>
		<dd><a href="343-2.html" id="doc-menu-2-343">微信JS-SDK调用</a></dd>
	</dl>
	<dl id="docdl-3">
		<dt>微信支付<i class="iconfont icon-jt-down"></i></dt>
		<dd><a href="https://pay.weixin.qq.com/wiki/doc/api/index.html" target="_blank">微信支付手册</a></dd>
		<dd><a href="344-3.html" id="doc-menu-3-344">公众号内支付</a></dd>
		<dd><a href="345-3.html" id="doc-menu-3-345">微信扫码支付</a></dd>
		<dd><a href="346-3.html" id="doc-menu-3-346">H5+ APP支付</a></dd>
		<dd><a href="347-3.html" id="doc-menu-3-347">微信小程序支付</a></dd>
	</dl>
	<dl id="docdl-4">
		<dt>小程序<i class="iconfont icon-jt-down"></i></dt>
		<dd><a href="348-4.html" id="doc-menu-4-348">小程序code换opennid</a></dd>
	</dl>
</div>
<script type="text/javascript">
function buyGraceWechat(){
	var gDialog = new graceDialog();
	gDialog.buttons = ['关闭', '知道了'];
	gDialog.alert('请联系客服 QQ 1265928288 购买【价格 ￥299】');
}
</script>	</div>
	<div class="grace-rows2 grace-r">
		<div style="line-height:2em; border-bottom:1px solid #F6F6F6; padding-bottom:12px;">
			<h1 class="grace-h3 grace-color-green">生成带参数的二维码</h1>
		</div>
		<div class="grace-content" style="padding:22px 0px;">
			<p><strong>公众号二维码说明</strong></p><p>为了满足用户渠道推广分析和用户帐号绑定等场景的需要，公众平台提供了生成带参数二维码的接口。使用该接口可以获得多个带不同场景值的二维码，用户扫描后，公众号可以接收到事件推送。</p><p><br/></p><p><strong>目前有2种类型的二维码</strong></p><p>1、临时二维码，是有过期时间的，最长可以设置为在二维码生成后的30天（即2592000秒）后过期，但能够生成较多数量。临时二维码主要用于帐号绑定等不要求二维码永久保存的业务场景<br/></p><p>2、永久二维码，是无过期时间的，但数量较少（目前为最多10万个）。永久二维码主要用于适用于帐号绑定、用户来源统计等场景。<br/></p><p><br/></p><p><strong>用户扫描带场景值二维码时，可能推送以下两种事件</strong></p><p>如果用户还未关注公众号，则用户可以关注公众号，关注后微信会将带场景值关注事件推送给开发者。<br/></p><p>如果用户已经关注公众号，在用户扫描后会自动进入会话，微信也会将带场景值扫描事件推送给开发者。<br/></p><p>获取带参数的二维码的过程包括两步，首先创建二维码ticket，然后凭借ticket到指定URL换取二维码。<br/><br/></p><p><strong>使用$hcWeChat-&gt;makeQrcode()函数快速生成二维码</strong><br/></p><p>参数 ：</p><p>1、二维码数据信息</p><p>2、生成后本地存储路径</p><p>3、类型（临时或者永久），默认 2592000 临时二维码，&quot;allTime&quot; 代表永久二维码</p><p><br/></p><p><strong>完整示例</strong></p><pre class="brush:php;toolbar:false">&lt;?php
class&nbsp;wxController&nbsp;extends&nbsp;grace{
&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;function&nbsp;index(){
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$gracewechat&nbsp;=&nbsp;tool(&#39;graceWeChat&#39;);
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//临时二维码
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$gracewechat-&gt;makeQrcode(array(&#39;scene_id&#39;&nbsp;=&gt;&nbsp;123456),&nbsp;&#39;qrcode_1&#39;);
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;echo&nbsp;&#39;&lt;img&nbsp;src=&quot;qrcode_1.png&quot;&nbsp;/&gt;&lt;br&nbsp;/&gt;&#39;;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//永久二维码&nbsp;字符型
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$gracewechat-&gt;makeQrcode(array(&#39;scene_str&#39;&nbsp;=&gt;&nbsp;&#39;hcoder&#39;),&nbsp;&#39;qrcode_2&#39;,&nbsp;&#39;allTime&#39;);
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;echo&nbsp;&#39;&lt;img&nbsp;src=&quot;qrcode_2.png&quot;&nbsp;/&gt;&lt;br&nbsp;/&gt;&#39;;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//永久二维码&nbsp;数字型
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$gracewechat-&gt;makeQrcode(array(&#39;scene_id&#39;&nbsp;=&gt;&nbsp;1818),&nbsp;&#39;qrcode_3&#39;,&nbsp;&#39;allTime&#39;);
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;echo&nbsp;&#39;&lt;img&nbsp;src=&quot;qrcode_3.png&quot;&nbsp;/&gt;&lt;br&nbsp;/&gt;&#39;;
&nbsp;&nbsp;&nbsp;&nbsp;}
}</pre><p><br/><strong>扫码识别演示</strong><br/></p><pre class="brush:php;toolbar:false">&lt;?php
class&nbsp;wxController&nbsp;extends&nbsp;grace{
&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;function&nbsp;index(){
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$gracewechat&nbsp;=&nbsp;tool(&#39;graceWeChat&#39;);
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//临时二维码
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$gracewechat-&gt;getMsg();
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if($gracewechat-&gt;msgType&nbsp;==&nbsp;&#39;event&#39;&nbsp;&amp;&amp;&nbsp;$gracewechat-&gt;event&nbsp;==&nbsp;&#39;SCAN&#39;){
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$gracewechat-&gt;reTextMsg(&#39;扫码参数：&#39;.&nbsp;$gracewechat-&gt;msg-&gt;EventKey);
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}
&nbsp;&nbsp;&nbsp;&nbsp;}
}</pre><p><br/></p>		</div>
	</div>
</div>
<div class="grace-footer-line"></div>
<div class="grace-footer">
	phpGrace 轻快的实力派！&nbsp;&nbsp;
	<br/>
</div>
<script type="text/javascript">
function showDownLoad(){
	var gDialog = new graceDialog();
	gDialog.buttons = ['关闭', '知道了'];
	var msg = '<a href="https://gitee.com/liukuaizhuan/phpgrace" target="_blank" style="color:#5FB878; font-weight:700;"> 请点击这里去 gitee 下载 phpGrace ^_^</a>'+
			"<br /> 有gitee 账户的同学<br />请给我们一个星星作为鼓励谢谢 ^_^<br />" ;
	gDialog.alert(msg);
}
$('#grace-menu').click(function(){
	var nav = $('#grace-nav');
	if(nav.is(':hidden')){nav.slideDown(100);}else{nav.slideUp(100);}
});
//百度统计
//粘贴代码
</script><script type="text/javascript">
var index = $('#docdl-1').index();
$('#grace-accordion').accordion(index);
$('#doc-menu-1-337').addClass('grace-current');
</script>
<script type="text/javascript" src="http://apps.bdimg.com/libs/prettify/r298/prettify.js"></script>
<script type="text/javascript">
$('pre').addClass('prettyprint');
$('table').each(function(){
	$(this).find('tr:even').find('td').css({background:'#F6F7F8'});
});
prettyPrint();
$('#nav-wx').addClass('grace-current');
</script>
</body>
</html><script>console.log("phpGrace Log : 控制器 : wechat, 方法 : info - 运行时间 : 7.76毫秒, 占用内存 : 22.77k");</script>