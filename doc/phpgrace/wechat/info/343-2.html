<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<title>微信JS-SDK调用</title>
<meta name="keywords" content="微信JS-SDK调用" />
<meta name="description" content="微信JS-SDK调用" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1" />
<link rel="stylesheet" href="../../statics/grace20200720.css" />
<link rel="stylesheet" href="https://at.alicdn.com/t/font_611166_2ypi64205d6.css" />
<script type="text/javascript" src="https://apps.bdimg.com/libs/jquery/2.1.4/jquery.min.js"></script>
<script type="text/javascript" src="../../statics/grace.js"></script>
</head>
<body>
<div class="grace-header">
	<div class="grace-main">
		<div class="grace-logo">
			<a href="../../index.html"><img src="../../statics/images/logo.png" /></a>
		</div>
		<ul class="grace-nav" id="grace-nav">
								<li><a href="javascript:;" onclick="showDownLoad()">下载</a></li>
								<li><a href="../../doc.html" id="nav-doc">手册</a></li>
			<li><a href="../../tools.html" id="nav-tool">工具</a></li>
			 
		</ul>
	</div>
	<div class="grace-menu" id="grace-menu"><i class="iconfont icon-menu"></i></div>
</div>
<div class="grace-header-line"></div>
<div class="grace-slide-menu" id="slide-menu-account">
	<a href="../../login.html">账户中心</a>
	<a href="../../login.html">我的话题</a>
	<a href="../../login.html">我的评论</a>
	<a href="../../index.html">退出系统</a>
</div>
<style type="text/css">@media screen and (max-width:800px){
	.grace-rows1{display:none;}
	.grace-rows2{width:94%; padding:5px 2%;}
}
</style>
<div class="grace-line-banner"></div>
<div class="grace-main grace-margin-top">
	<div class="grace-rows1 grace-l">
		<div class="grace-accordion" id="grace-accordion">
	<dl id="docdl-0" class="grace-mobile-hide">
		<dt>graceWechat<i class="iconfont icon-jt-down"></i></dt>
		<dd class="grace-mobile-hide"><a href="../../wechat.html" id="doc-menu-0-0">graceWechat 介绍</a></dd>
	</dl>
	<dl id="docdl-1">
		<dt>微信公众号常用<i class="iconfont icon-jt-down"></i></dt>
		<dd><a href="328-1.html" id="doc-menu-1-328">公众号开发资料</a></dd>
		<dd><a href="329-1.html" id="doc-menu-1-329">快速接入公众号</a></dd>
		<dd><a href="330-1.html" id="doc-menu-1-330">关注、取消关注</a></dd>
		<dd><a href="331-1.html" id="doc-menu-1-331">接收、回复消息</a></dd>
		<dd><a href="332-1.html" id="doc-menu-1-332">消息数据日志</a></dd>
		<dd><a href="333-1.html" id="doc-menu-1-333">综合消息处理</a></dd>
		<dd><a href="334-1.html" id="doc-menu-1-334">Access Token</a></dd>
		<dd><a href="335-1.html" id="doc-menu-1-335">自定义菜单</a></dd>
		<dd><a href="336-1.html" id="doc-menu-1-336">临时素材管理</a></dd>
		<dd><a href="337-1.html" id="doc-menu-1-337">二维码生成及识别</a></dd>
		<dd><a href="338-1.html" id="doc-menu-1-338">长链转短链</a></dd>
		<dd><a href="339-1.html" id="doc-menu-1-339">模板消息</a></dd>
		<dd><a href="340-1.html" id="doc-menu-1-340">获取用户信息</a></dd>
	</dl>
	<dl id="docdl-2">
		<dt>网页开发及授权<i class="iconfont icon-jt-down"></i></dt>
		<dd><a href="341-2.html" id="doc-menu-2-341">前端框架推荐</a></dd>
		<dd><a href="342-2.html" id="doc-menu-2-342">微信网页授权</a></dd>
		<dd><a href="../../tools/info/17.html" target="_blank">微信扫码登录</a></dd>
		<dd><a href="343-2.html" id="doc-menu-2-343">微信JS-SDK调用</a></dd>
	</dl>
	<dl id="docdl-3">
		<dt>微信支付<i class="iconfont icon-jt-down"></i></dt>
		<dd><a href="https://pay.weixin.qq.com/wiki/doc/api/index.html" target="_blank">微信支付手册</a></dd>
		<dd><a href="344-3.html" id="doc-menu-3-344">公众号内支付</a></dd>
		<dd><a href="345-3.html" id="doc-menu-3-345">微信扫码支付</a></dd>
		<dd><a href="346-3.html" id="doc-menu-3-346">H5+ APP支付</a></dd>
		<dd><a href="347-3.html" id="doc-menu-3-347">微信小程序支付</a></dd>
	</dl>
	<dl id="docdl-4">
		<dt>小程序<i class="iconfont icon-jt-down"></i></dt>
		<dd><a href="348-4.html" id="doc-menu-4-348">小程序code换opennid</a></dd>
	</dl>
</div>
<script type="text/javascript">
function buyGraceWechat(){
	var gDialog = new graceDialog();
	gDialog.buttons = ['关闭', '知道了'];
	gDialog.alert('请联系客服 QQ 1265928288 购买【价格 ￥299】');
}
</script>	</div>
	<div class="grace-rows2 grace-r">
		<div style="line-height:2em; border-bottom:1px solid #F6F6F6; padding-bottom:12px;">
			<h1 class="grace-h3 grace-color-green">微信JS-SDK调用</h1>
		</div>
		<div class="grace-content" style="padding:22px 0px;">
			<p><strong>微信JS-SDK概述</strong></p><p>微信JS-SDK是微信公众平台面向网页开发者提供的基于微信内的网页开发工具包。</p><p>通过使用微信JS-SDK，网页开发者可借助微信高效地使用拍照、选图、语音、位置等手机系统的能力，同时可以直接使用微信分享、扫一扫、卡券、支付等微信特有的能力，为微信用户提供更优质的网页体验。</p><p><br/></p><p>JSSDK使用步骤</p><p><strong>步骤一：绑定域名</strong><br/></p><p>先登录微信公众平台进入“公众号设置”的“功能设置”里填写“JS接口安全域名”。<br/></p><p>备注：登录后可在“开发者中心”查看对应的接口权限。<br/></p><p><strong>步骤二：引入JS文件</strong><br/></p><p>在需要调用JS接口的页面引入如下JS文件，（支持https）：http://res.wx.qq.com/open/js/jweixin-1.2.0.js<br/></p><p>备注：支持使用 AMD/CMD 标准模块加载方法加载<br/></p><p><strong>步骤三：通过config接口注入权限验证配置</strong><br/></p><p>所有需要使用JS-SDK的页面必须先注入配置信息，否则将无法调用（同一个url仅需调用一次，对于变化url的SPA的web app可在每次url变化时进行调用,目前Android微信客户端不支持pushState的H5新特性，所以使用pushState来实现web app的页面会导致签名失败，此问题会在Android6.2中修复）。<br/></p><pre class="brush:php;toolbar:false">wx.config({
&nbsp;&nbsp;&nbsp;&nbsp;debug:&nbsp;true,&nbsp;//&nbsp;开启调试模式,调用的所有api的返回值会在客户端alert出来，若要查看传入的参数，可以在pc端打开，参数信息会通过log打出，仅在pc端时才会打印。
&nbsp;&nbsp;&nbsp;&nbsp;appId:&nbsp;&#39;&#39;,&nbsp;//&nbsp;必填，公众号的唯一标识
&nbsp;&nbsp;&nbsp;&nbsp;timestamp:&nbsp;,&nbsp;//&nbsp;必填，生成签名的时间戳
&nbsp;&nbsp;&nbsp;&nbsp;nonceStr:&nbsp;&#39;&#39;,&nbsp;//&nbsp;必填，生成签名的随机串
&nbsp;&nbsp;&nbsp;&nbsp;signature:&nbsp;&#39;&#39;,//&nbsp;必填，签名，见附录1
&nbsp;&nbsp;&nbsp;&nbsp;jsApiList:&nbsp;[]&nbsp;//&nbsp;必填，需要使用的JS接口列表，所有JS接口列表见附录2
});</pre><p><strong>步骤四：通过ready接口处理成功验证</strong><br/></p><pre class="brush:php;toolbar:false">wx.ready(function(){
&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;config信息验证后会执行ready方法，所有接口调用都必须在config接口获得结果之后，config是一个客户端的异步操作，
&nbsp;&nbsp;&nbsp;&nbsp;所以如果需要在页面加载时就调用相关接口，则须把相关接口放在ready函数中调用来确保正确执行。对于用户触发时才调用的接口，则可以直接调用，不需要放在ready函数中。
});</pre><p><strong>步骤五：通过error接口处理失败验证</strong><br/></p><pre class="brush:php;toolbar:false">wx.error(function(res){
&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;config信息验证失败会执行error函数，如签名过期导致验证失败，具体错误信息可以打开config的debug模式查看，也可以在返回的res参数中查看，对于SPA可以在这里更新签名。
});</pre><p><br/><strong>告别复杂，使用$gracewechat-&gt;getJsTicket(); 一步完成配置过程！</strong></p><p><br/><strong>完整演示代码</strong><br/>ulr : http://www.phpgrace.com/wx/jssdk<br/>控制器代码：<br/></p><pre class="brush:php;toolbar:false">&lt;?php
class&nbsp;wxController&nbsp;extends&nbsp;grace{
&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;function&nbsp;index(){
&nbsp;&nbsp;&nbsp;&nbsp;}
&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;function&nbsp;jssdk(){
&nbsp;&nbsp;&nbsp;&nbsp;}
}</pre><p>视图文件代码<br/></p><pre class="brush:php;toolbar:false">&lt;!DOCTYPE&nbsp;html&gt;
&lt;html&gt;
&lt;head&gt;
&lt;meta&nbsp;charset=&quot;utf-8&quot;&gt;
&lt;meta&nbsp;name=&quot;viewport&quot;&nbsp;content=&quot;initial-scale=1.0,&nbsp;maximum-scale=1.0,&nbsp;user-scalable=no&quot;&nbsp;/&gt;
&lt;title&gt;页面分享&lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;
&lt;div&nbsp;style=&quot;text-align:ccenter;&nbsp;font-size:22px;&quot;&gt;
&nbsp;&nbsp;&nbsp;&nbsp;分享测试
&lt;/div&gt;
&lt;script&nbsp;type=&quot;text/javascript&quot;&nbsp;src=&quot;http://res.wx.qq.com/open/js/jweixin-1.2.0.js&quot;&gt;&lt;/script&gt;
&lt;script&nbsp;type=&quot;text/javascript&quot;&gt;
&lt;?php
$gracewechat&nbsp;=&nbsp;tool(&#39;graceWeChat&#39;);
$jsConfig&nbsp;=&nbsp;$gracewechat-&gt;getJsTicket();
?&gt;
wx.config({
&nbsp;&nbsp;&nbsp;&nbsp;debug:&nbsp;true,
&nbsp;&nbsp;&nbsp;&nbsp;appId:&nbsp;&#39;&lt;?php&nbsp;echo&nbsp;$gracewechat-&gt;appId;?&gt;&#39;,&nbsp;//&nbsp;必填，公众号的唯一标识
&nbsp;&nbsp;&nbsp;&nbsp;timestamp:&nbsp;&lt;?php&nbsp;echo&nbsp;$jsConfig[&quot;timestamp&quot;];?&gt;,
&nbsp;&nbsp;&nbsp;&nbsp;nonceStr:&nbsp;&#39;&lt;?php&nbsp;echo&nbsp;$jsConfig[&quot;nonceStr&quot;];?&gt;&#39;,
&nbsp;&nbsp;&nbsp;&nbsp;signature:&nbsp;&#39;&lt;?php&nbsp;echo&nbsp;$jsConfig[&quot;signature&quot;];?&gt;&#39;,
&nbsp;&nbsp;&nbsp;&nbsp;jsApiList:&nbsp;[
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#39;chooseImage&#39;,&nbsp;&#39;previewImage&#39;,&nbsp;&#39;uploadImage&#39;,&nbsp;&#39;downloadImage&#39;,&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#39;startRecord&#39;,&nbsp;&#39;stopRecord&#39;,&nbsp;&#39;onVoiceRecordEnd&#39;,&nbsp;&#39;playVoice&#39;,&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#39;pauseVoice&#39;,&nbsp;&#39;stopVoice&#39;,&nbsp;&#39;onVoicePlayEnd&#39;,&nbsp;&#39;uploadVoice&#39;,&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#39;downloadVoice&#39;,&nbsp;&#39;onMenuShareTimeline&#39;,&nbsp;&#39;onMenuShareAppMessage&#39;,&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#39;onMenuShareQQ&#39;,&nbsp;&#39;onMenuShareQZone&#39;
&nbsp;&nbsp;&nbsp;&nbsp;]
});
&lt;?php
$title&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;&#39;graceWechat&nbsp;分享测试&#39;;
$shareImg&nbsp;=&nbsp;&#39;http://wx.hcoder.net/demo/imgs/share.jpg&#39;;
?&gt;
wx.ready(function(){
&nbsp;&nbsp;&nbsp;&nbsp;wx.onMenuShareTimeline({
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;title:&nbsp;&#39;&lt;?php&nbsp;echo&nbsp;$title;?&gt;&#39;,
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;link:&nbsp;location.href,&nbsp;//&nbsp;分享链接
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imgUrl:&nbsp;&#39;&lt;?php&nbsp;echo&nbsp;$shareImg;?&gt;&#39;,&nbsp;//&nbsp;分享图标
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;success:&nbsp;function(){},
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cancel:&nbsp;function(){}
&nbsp;&nbsp;&nbsp;&nbsp;});
&nbsp;&nbsp;&nbsp;&nbsp;wx.onMenuShareAppMessage({
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;title:&nbsp;&#39;&lt;?php&nbsp;echo&nbsp;$title;?&gt;&#39;,
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;desc:&nbsp;&#39;power&nbsp;by&nbsp;hcoder.net&#39;,
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;link:&nbsp;location.href,
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imgUrl:&nbsp;&#39;&lt;?php&nbsp;echo&nbsp;$shareImg;?&gt;&#39;,&nbsp;//&nbsp;分享图标
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;success:&nbsp;function(){},
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cancel:&nbsp;function(){}
&nbsp;&nbsp;&nbsp;&nbsp;});
});
&lt;/script&gt;
&lt;/body&gt;
&lt;/html&gt;</pre><p><br/><strong>说明</strong><br/>配置好 jssdk 后即可开启微信 js 之旅，您可以轻松实现： 分享、图片、语音、位置、扫一扫、支付等多种 js 接口！<br/>相关资料地址 :&nbsp;<a href="https://mp.weixin.qq.com/wiki?t=resource/res_main&amp;id=mp1421141115" target="_blank" title="https://mp.weixin.qq.com/wiki?t=resource/res_main&amp;id=mp1421141115">https://mp.weixin.qq.com/wiki?t=resource/res_main&amp;id=mp1421141115</a></p>		</div>
	</div>
</div>
<div class="grace-footer-line"></div>
<div class="grace-footer">
	phpGrace 轻快的实力派！&nbsp;&nbsp;
	<br/>
</div>
<script type="text/javascript">
function showDownLoad(){
	var gDialog = new graceDialog();
	gDialog.buttons = ['关闭', '知道了'];
	var msg = '<a href="https://gitee.com/liukuaizhuan/phpgrace" target="_blank" style="color:#5FB878; font-weight:700;"> 请点击这里去 gitee 下载 phpGrace ^_^</a>'+
			"<br /> 有gitee 账户的同学<br />请给我们一个星星作为鼓励谢谢 ^_^<br />" ;
	gDialog.alert(msg);
}
$('#grace-menu').click(function(){
	var nav = $('#grace-nav');
	if(nav.is(':hidden')){nav.slideDown(100);}else{nav.slideUp(100);}
});
//百度统计
//粘贴代码
</script><script type="text/javascript">
var index = $('#docdl-2').index();
$('#grace-accordion').accordion(index);
$('#doc-menu-2-343').addClass('grace-current');
</script>
<script type="text/javascript" src="http://apps.bdimg.com/libs/prettify/r298/prettify.js"></script>
<script type="text/javascript">
$('pre').addClass('prettyprint');
$('table').each(function(){
	$(this).find('tr:even').find('td').css({background:'#F6F7F8'});
});
prettyPrint();
$('#nav-wx').addClass('grace-current');
</script>
</body>
</html><script>console.log("phpGrace Log : 控制器 : wechat, 方法 : info - 运行时间 : 6.17毫秒, 占用内存 : 26.74k");</script>